{
  "hash": "9f84b190638c220565b727e58c0bac14",
  "result": {
    "markdown": "---\ntitle: \"4 - Méthode X13-ARIMA\"\n---\n\n\n\n\n### Objectifs de cette séquence\n\nCette séquence a pour objectif de vous présenter les concepts de base relatifs à la méthode X13-ARIMA.  \n\n\nAprès cette séquence vous saurez :  \n\n- les vocabulaires relatifs à la méthode X13-ARIMA  \n\n- la structure de la méthode X13-ARIMA en deux étapes   \n\n- le fonctionnement et la finalité de la phase de pré-ajustement   \n\n- le principe de la décomposition\n\n### Questions de positionnement\n\nQuels usages de la phase de pré-ajustement dans la méthode X13-ARIMA ?\n\\vfill\n\nQuels sont les Outliers les plus couramment détectés ?\n\\vfill\n\nÀ quoi sert un modèle ARIMA dans la méthode X13-ARIMA ?\n\\vfill\n\nQu'est ce que X11 ?\n\\vfill\n\nQu'est ce que le principe itératif dans la décomposition ?\n\\vfill\n\n### X13-ARIMA\n\nX pour eXperience…  \n\nDeux modules :   \n\n- REG-ARIMA : phase de pré-ajustement  \nCorrection préalable par régression linéaire des points aberrants, ruptures de tendance, effets de calendrier.  \n\nModélisation ARIMA : pour prolonger la série brute afin de résoudre partiellement le problème des fins de série lié aux moyennes mobiles symétriques.\n\n\n- X11 : phase de décomposition  \n\nDécomposition de la série en tendance-cycle, saisonnalité et irrégulier, à l'aide de moyennes mobiles.\n\n\n# Phase de pré-ajustement : modèle Reg-ARIMA\n## Série linéarisée\n\n### Linéariser la série\n\nLes moyennes mobiles, comme les modèles ARIMA, sont des opérateurs linéaires. Il faut donc préalablement **supprimer les «\\ non-linéarités\\ »** des séries (points aberrants, effets de calendrier, ruptures…)\n\nPar régression linéaire sur les :\n\n- outliers (points aberrants et ruptures)  \n- effets de calendrier {{< fa arrow-circle-right >}} séquence de demain matin  \n- autres régresseurs éventuels (ex : température moyenne, vacances scolaires…)  \n\nSérie linéarisée = $\\left(Y_t - \\sum \\hat{\\alpha_i}X_{it}\\right)$ où les $X_i$ modélisent les «\\ non-linéarités\\ »\n\n## Outliers et autres régresseurs\n\n### Les principaux types d'outliers\n\n\\smallskip\n\n:::: {.columns}\n::: {.column width=\"60%\"}\n**Choc ponctuel**\n\n*Additive outlier* (AO)\n\nAffecte l'Irrégulier\n:::\n::: {.column width=\"30%\"}\n\\input{img/AO.tex}\n:::\n::::\n\n:::: {.columns}\n::: {.column width=\"60%\"}\n**Changement de niveau**\n\n*Level Shift* (LS)\n\nAffecte la Tendance\n:::\n::: {.column width=\"30%\"}\n\\input{img/LS.tex}\n:::\n::::\n\n\n:::: {.columns}\n::: {.column width=\"60%\"}\n**Changement de niveau transitoire**\n\n*Transitory Change* (TC)\n\nAffecte l'Irrégulier\n:::\n::: {.column width=\"30%\"}\n\\input{img/TC.tex}\n:::\n::::\n\n\n:::: {.columns}\n::: {.column width=\"60%\"}\n**Rupture de profil saisonnier**\n\n*Seasonal Outlier* (SO)\n\nAffecte la Composante Saisonnière\n:::\n::: {.column width=\"30%\"}\n\\input{img/SO.tex}\n:::\n::::\n\n\n### Autres outliers *atypiques*\n\n\\smallskip\n\n:::: {.columns}\n::: {.column width=\"60%\"}\n**Effet de rampe**\n\n*Ramp effect* (RP)\n\nAffecte la Tendance\n:::\n::: {.column width=\"30%\"}\n\\input{img/Ramp.tex}\n:::\n::::\n\n\n:::: {.columns}\n::: {.column width=\"60%\"}\n**Rupture en niveau temporaire**\n\n*Tempory Level Shift* (TLS)\n\nAffecte la Tendance\n:::\n::: {.column width=\"30%\"}\n\\input{img/TLS.tex}\n:::\n::::\n\n:::: {.columns}\n::: {.column width=\"60%\"}\n*Pure seasonal outlier* (PSO)\n\nAffecte la Composante Saisonnière\n:::\n::: {.column width=\"30%\"}\n\\input{img/PSO.tex}\n:::\n::::\n\n\n### Variables de régression associées aux outliers\n\\footnotesize\n\n:::: {.columns}\n::: {.column width=\"45%\"}\n\\begin{align*}\n&AO_t^{t_0} = \\begin{cases}\n1 & t=t_0 \\\\\n0 & t\\ne t_0\n\\end{cases}\n\\phantom{\\begin{cases}\n\\\\ \\\\ \\\\\n\\end{cases}}\n\\\\\n&LS_t^{t_0} = \\begin{cases}\n-1 & t<t_0 \\\\\n0 & t\\geq t_0\n\\end{cases}\n\\phantom{\\begin{cases}\n\\\\ \\\\ \\\\\n\\end{cases}}\n\\\\\n&TC_t^{t_0} = \\begin{cases}\n0 & t<t_0 \\\\\n\\alpha^{t-t_0} & t\\geq t_0\n\\end{cases}\n\\\\\n&\\text{avec }\\alpha\\in]0,1[\\text{ ($\\alpha=0,7$ par défaut)}&\n\\\\\n&SO_t^{t_0} = \\begin{cases}\n1 & t<t_0 \\text{, $t$ même mois que }t_0\\\\\n-\\frac{1}{s-1} & t < t_0\\text{, $t$ autre mois que }t_0 \\\\\n0 & t\\geq t_0\n\\end{cases}\n\\\\\n&\\text{avec $s$ la périodicité de la série}&\n\\end{align*}\n:::\n::: {.column width=\"45%\"}\n\\begin{align*}\nRP_t^{(t_0,t_1)}&=\n\\begin{cases}\n-1 & t\\geq t_0 \\\\\n-\\frac{t-t_0}{t_1-t_0}-1 & t_0< t < t_1 \\\\\n0 & t \\leq t_1\n\\end{cases}\n\\\\\nTLS_t^{(t_0,t_1)}&=\n\\begin{cases}\n0 & t < t_0 \\\\\n1 & t_0 \\leq t \\leq t_1 \\\\\n0 & t > t_1\n\\end{cases}\n\\\\\n&\n\\\\\n PSO_t^{(t_0,j)} &=\\begin{cases}\n1 & \\text{$t$ même mois que $j$, }t<t_0 \\\\\n0 & \\text{$t$ autre mois que $j$ ou }t \\geq t_0 \\\\\n-1 & \\text{$t$ même mois que $t_0$, }t < t_0\n\\end{cases}\n\\\\\n&\n\\end{align*}\n:::\n::::\n\n\n### Outliers : résumé graphique\n\\input{img/outliers.tex}\n\n\n\n## Modèle ARIMA\n\n### La modélisation Reg-ARIMA\nLe modèle Reg-ARIMA :\n$$\n\\left(Y_t - \\sum \\hat{\\alpha_i}X_{it}\\right) \\sim ARIMA(p,d,q)(P,D,Q)\n$$\noù les $X_i$ modélisent les «\\ non-linéarités\\ »\n\nLe modèle ARIMA capture toute l'information temporelle, le résidu du modèle Reg-ARIMA est un bruit blanc  \n\nLe modèle ARIMA est utilisé pour faire la prévision sur la série linéarisée  \n\nLa structure du modèle Reg-ARIMA, ainsi que sa détermination seront vues en détail lors d'une autre session\n\n\n# Phase de décomposition (X11)\n## Les moyennes mobiles \n### Les moyennes mobiles (1/2)\nLa décomposition X11 utilise les filtres que sont les moyennes mobiles\n\n**Une MM est un opérateur linéaire :**  \nLinéarité : $M(X_t+Y_t) = M(X_t)+M(Y_t)$  \n\n**3 types de MM utilisés par X11 :**\n\n1. Moyennes mobiles simples (pour extraire la tendance) $\\rightarrow M_{2\\times 12}$ (ou $M_{2\\times 4}$ pour séries trim)\n\n    + conserve la tendance linéaire (locale) : $M (at+b)=at+b \\implies M (TC_t)\\simeq TC_t$\n    \n    + élimine la saisonnalité stable : $M (S_t)=0$ \n    \n    + réduit le bruit :  $\\mathbb V \\big[M (I_t)\\big] \\ll \\mathbb V \\big[I_t\\big] \\implies M (I_t)\\simeq 0$\n\n\n### Les moyennes mobiles (2/2)\n\n\n\n2. Moyennes mobiles de Macurves (pour extraire la saisonnalité) $\\rightarrow M_{3\\times 5}$\n\n    + réduit le bruit  \n    \n    + conserve la saisonnalité stable : $M (S_t)= S_t$  \n\n3. Moyennes mobiles de Henderson (pour extraire la tendance) $\\rightarrow H_{13}$ (ou $H_{7}$ pour séries trim)\n\n    + conserve la tendance polynomiale (ordre 3) : $M (at^3+bt^2+ct+d)=at^3+bt^2+ct+d$ \n    \n    + n'élimine pas la saisonnalité : $M (S_t) \\ne 0$ et $M (S_t) \\ne S_t$\n    \n    + réduit le bruit au maximum  \n\n## Le principe itératif de X11\n\n### Principe itératif de X11 (1/2)\nUne première estimation de la CVS : \n\n1. Estimation de la **tendance-cycle** par moyenne mobile $2\\times 12$ (ou $2\\times 4$) :\n$$\nTC_t^{(1)}=M_{2\\times 12}(X_t)\n$$\n2. Estimation de la composante **saisonnier-irrégulier** : \n$$\n(S_t+I_t)^{(1)}= X_t - TC_t^{(1)}\n$$\n3. Estimation de la composante **saisonnière** par moyenne mobile $3\\times 3$ sur **chaque mois** :\n$$\nS_t^{(1)}= M_{3\\times 3}\\left[(S_t+I_t)^{(1)}\\right]\n\\text{ et normalisation }\nSnorm_t^{(1)}=S_t^{(1)} - M_{2\\times 12}\\left(S_t^{(1)}\\right)\n$$\n4. Estimation de la série corrigée des variations saisonnières : \n$$\nXsa_t^{(1)}= (TC_t+I_t)^{(1)} = X_t - Snorm_t^{(1)}\n$$\n\n### Principe itératif de X11 (2/2)\nUne seconde estimation de la CVS : \n\n1. Estimation de la **tendance-cycle** par moyenne de Henderson (généralement 13 termes ou 5 pour séries trim) :\n$$\nTC_t^{(2)}=H_{13}(Xsa_t^{(1)})\n$$\n2. Estimation de la composante **saisonnier-irrégulier** : \n$$\n(S_t+I_t)^{(2)}= X_t - TC_t^{(2)}\n$$\n3. Estimation de la composante **saisonnière** par moyenne mobile $3\\times 5$ (généralement) sur **chaque mois** :\n$$\nS_t^{(2)}= M_{3\\times 5}\\left[(S_t+I_t)^{(2)}\\right]\n\\text{ et normalisation }\nSnorm_t^{(2)}=S_t^{(2)} - M_{2\\times 12}\\left(S_t^{(2)}\\right)\n$$\n4. Estimation de la série corrigée des variations saisonnières : \n$$\nXsa_t^{(2)}= (TC_t+I_t)^{(2)} = X_t - Snorm_t^{(2)}\n$$\n\n## Les étapes X11\n\n### Les étapes de X11 \n7 grandes étapes A à G  \n\n**Étape A :** ajustements préalables (n'est plus utile)  \n\n**Étapes B et C :** corrections automatiques (sur l'Irrégulier)  \n\n**Étape D :** désaisonnalisation finale  \n\n**Étapes E, F et G :** indicateurs et graphiques pour juger de la qualité de la décomposition (n'est plus utile avec JDemetra+)\n\n\n### Les corrections automatiques de X11 (2/2)\n\nIl existe un algorithme de détection et de correction des outliers et des effets de calendrier dans X11, **indépendant du module reg-ARIMA**.  \n\nCes détections sont faites sur la **composante irrégulière**.  \n\nElles s'effectuent dans les étapes B, C et D.  \n\nQuand on n'autorise pas la correction des outliers dans la phase de pré-ajustement, X11 le fait quand même dans la phase de décomposition, avec pour conséquences :\n\n- moins de visibilité et de maîtrise sur les outliers, leur nombre et leur nature (AO, LS ou TC) ;  \n\n- la prévision du modèle Reg-ARIMA sera moins précise.\n\n\n###  Les corrections automatiques de X11 (2/2)\n\n\\footnotesize\n\nÉtape 1 : calcul d'un écart-type mobile de l'irrégulier sur des intervalles de 5 ans\n\n- Tout point $I_t$ de l'année centrale telle que $\\lvert I_t - m\\rvert >2,5 \\sigma_t$ est considéré comme aberrant et « supprimé »\n\n- On recalcule l'écart-type (estimation plus robuste)\n\n\nÉtape 2 : On affecte un poids à chaque $I_t$ en fonction du $\\sigma$ associé (l'année centrale étant l'année de $t$)\n\n![](img/correction_auto_X11.png){width=90%}\n\n\n###  Bilan des étapes de X11\n\n\\centering\n\n![](img/X11_JD+.PNG){width=100%}\n\n# Conclusion\n\n### Les essentiels\n\n- X13-ARIMA travaille en deux phases : pré-ajustement et décomposition  \n\n- Le pré-ajustement linéarise (par régression) et prolonge les séries en faisant des prévisions (par modèle ARIMA)  \n\n- La décomposition X11 estime la composante Saisonnière  \n\n- X11 utilise plusieurs moyennes mobiles ayant des propriétés complémentaires, de manière successive et itérative : principe itératif de X11\n\n\n\n",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": null,
    "postProcess": false
  }
}